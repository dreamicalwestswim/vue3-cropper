(function(e){function t(t){for(var i,r,c=t[0],l=t[1],h=t[2],u=0,g=[];u<c.length;u++)r=c[u],Object.prototype.hasOwnProperty.call(o,r)&&o[r]&&g.push(o[r][0]),o[r]=0;for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(e[i]=l[i]);s&&s(t);while(g.length)g.shift()();return n.push.apply(n,h||[]),a()}function a(){for(var e,t=0;t<n.length;t++){for(var a=n[t],i=!0,c=1;c<a.length;c++){var l=a[c];0!==o[l]&&(i=!1)}i&&(n.splice(t--,1),e=r(r.s=a[0]))}return e}var i={},o={app:0},n=[];function r(t){if(i[t])return i[t].exports;var a=i[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=e,r.c=i,r.d=function(e,t,a){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(a,i,function(t){return e[t]}.bind(null,i));return a},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],l=c.push.bind(c);c.push=t,c=c.slice();for(var h=0;h<c.length;h++)t(c[h]);var s=l;n.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"1d75":function(e,t,a){},"56d7":function(e,t,a){"use strict";a.r(t);a("e260"),a("e6cf"),a("cca6"),a("a79d");var i=a("7a23"),o={class:"home"};function n(e,t,a,n,r,c){var l=Object(i["p"])("Cropper");return Object(i["k"])(),Object(i["e"])("div",o,[Object(i["h"])("input",{type:"file",accept:"image/*",onChange:t[1]||(t[1]=function(){return n.onChange&&n.onChange.apply(n,arguments)})},null,32),e.previewImage?(Object(i["k"])(),Object(i["e"])("img",{key:0,src:e.previewImage,alt:"预览图",style:{"max-width":"100%","max-height":"100%"}},null,8,["src"])):Object(i["f"])("",!0),e.cropperVisible?(Object(i["k"])(),Object(i["e"])(l,{key:1,imagePath:e.imagePath,fileType:"blob",onSave:n.onSave,onCancel:n.onCancel},null,8,["imagePath","onSave","onCancel"])):Object(i["f"])("",!0)])}a("d3b7"),a("3ca3"),a("ddb0"),a("2b3d");var r=a("5530"),c=window.URL||window.webkitURL,l={name:"App",setup:function(){var e=Object(i["n"])({cropperVisible:!1,imagePath:"",previewImage:null}),t=function(t){var a=t.target.files[0];e.imagePath=c.createObjectURL(a),e.cropperVisible=!0},a=function(t){e.previewImage="string"===typeof t?t:c.createObjectURL(t),e.cropperVisible=!1},o=function(){e.cropperVisible=!1};return Object(r["a"])(Object(r["a"])({},Object(i["r"])(e)),{},{onChange:t,onSave:a,onCancel:o})}};l.render=n;var h=l,s=(a("b0c0"),a("99af"),Object(i["t"])("data-v-e3713b5c"));Object(i["m"])("data-v-e3713b5c");var u={class:"face"},g={key:0,class:"size-num"},d=Object(i["g"])('<div class="mask" data-name="mask" data-v-e3713b5c></div><div class="line-top" data-v-e3713b5c></div><div class="line-right" data-v-e3713b5c></div><div class="line-bottom" data-v-e3713b5c></div><div class="line-left" data-v-e3713b5c></div>',5),p=Object(i["g"])('<div class="dot-tl" data-name="dot-tl" data-v-e3713b5c></div><div class="dot-tc" data-name="dot-tc" data-v-e3713b5c></div><div class="dot-tr" data-name="dot-tr" data-v-e3713b5c></div><div class="dot-rc" data-name="dot-rc" data-v-e3713b5c></div><div class="dot-rb" data-name="dot-rb" data-v-e3713b5c></div><div class="dot-bc" data-name="dot-bc" data-v-e3713b5c></div><div class="dot-bl" data-name="dot-bl" data-v-e3713b5c></div><div class="dot-lc" data-name="dot-lc" data-v-e3713b5c></div>',8),f={class:"cropper__control"},b=Object(i["h"])("div",{class:"cropper__line"},null,-1),v={class:"cropper__control"};Object(i["l"])();var m=s((function(e,t,a,o,n,r){return Object(i["k"])(),Object(i["e"])(i["b"],{to:"body"},[Object(i["h"])("div",Object(i["i"])({class:"cropper"},e.$attrs),[Object(i["h"])("div",{ref:"stage",class:"cropper__stage",onTouchstart:t[1]||(t[1]=function(){return o.onTouchStart&&o.onTouchStart.apply(o,arguments)}),onTouchmove:t[2]||(t[2]=function(){return o.onTouchMove&&o.onTouchMove.apply(o,arguments)}),onTouchend:t[3]||(t[3]=function(){return o.onTouchEnd&&o.onTouchEnd.apply(o,arguments)}),style:{visibility:e.loadComplete?"visible":"hidden"}},[Object(i["h"])("img",{class:"cropper__img",ref:"imageRef",src:e.img,alt:"",style:{transform:"translate3d(".concat(e.originalImage.left,"px,").concat(e.originalImage.top,"px,0) rotateZ(").concat(e.originalImage.rotate,"deg) scale(").concat(e.originalImage.scale,")")}},null,12,["src"]),Object(i["h"])("div",{class:"cropper__box",style:{width:"".concat(e.cropBox.width,"px"),height:"".concat(e.cropBox.height,"px"),transform:"translate3d(".concat(e.cropBox.left,"px,").concat(e.cropBox.top,"px,0)")}},[Object(i["h"])("div",u,[Object(i["h"])("img",{src:e.img,alt:"",style:{transform:"translate3d(".concat(e.originalImage.left-e.cropBox.left,"px,").concat(e.originalImage.top-e.cropBox.top,"px,0) rotateZ(").concat(e.originalImage.rotate,"deg) scale(").concat(e.originalImage.scale,")")}},null,12,["src"])]),a.showOutputSize?(Object(i["k"])(),Object(i["e"])("div",g,Object(i["q"])("".concat(o.outputSizeInfo.width," x ").concat(o.outputSizeInfo.height)),1)):Object(i["f"])("",!0),d,a.fixedBox?Object(i["f"])("",!0):(Object(i["k"])(),Object(i["e"])(i["a"],{key:1},[p],64))],4)],36),Object(i["h"])("div",f,[Object(i["h"])("div",{class:"cropper__icon-rotate",onClick:t[4]||(t[4]=function(){return o.onRotate&&o.onRotate.apply(o,arguments)})})]),b,Object(i["h"])("div",v,[Object(i["h"])("span",{onClick:t[5]||(t[5]=function(){return o.onCancel&&o.onCancel.apply(o,arguments)})},"取消"),Object(i["h"])("span",{onClick:t[6]||(t[6]=function(){return o.onReset&&o.onReset.apply(o,arguments)})},"还原"),Object(i["h"])("span",{onClick:t[7]||(t[7]=function(){return o.onCrop&&o.onCrop.apply(o,arguments)})},"选取")])],16)])}));a("a9e3"),a("a630"),a("a15b"),a("fb6a"),a("c19f"),a("ac1f"),a("466d"),a("5319"),a("1276"),a("5cc6"),a("9a8c"),a("a975"),a("735e"),a("c1ac"),a("d139"),a("3a7b"),a("d5d6"),a("82f8"),a("e91f"),a("60bd"),a("5f96"),a("3280"),a("3fcc"),a("ca91"),a("25a1"),a("cd26"),a("3c5d"),a("2954"),a("649e"),a("219c"),a("170b"),a("b39a"),a("72f7");function w(e){return Array.from?Array.from(e):Array.slice.call(e)}function y(e,t){var a=[],i=8192,o=new Uint8Array(e);while(o.length>0)a.push(String.fromCharCode.apply(null,w(o.subarray(0,i)))),o=o.subarray(i);return"data:".concat(t,";base64,").concat(btoa(a.join("")))}function O(e,t){var a=new XMLHttpRequest;a.open("GET",e,!0),a.responseType="blob",a.onload=function(){200!=this.status&&0!==this.status||t(this.response)},a.send()}function j(e){var t=e.replace(/^data:.*,/,""),a=atob(t),i=new ArrayBuffer(a.length),o=new Uint8Array(i),n=a.length;while(n--)o[n]=a.charCodeAt(n);return i}function I(e,t,a){var i,o="";for(i=t,a+=t;i<a;i++)o+=String.fromCharCode(e.getUint8(i));return o}function x(e){var t=e.split(","),a=t[0].match(/:(.*?);/)[1],i=window.atob(t[1]),o=i.length,n=new Uint8Array(o);while(o--)n[o]=i.charCodeAt(o);return new Blob([n],{type:a})}function k(e){var t,a=new DataView(e);try{var i,o,n;if(255===a.getUint8(0)&&216===a.getUint8(1)){var r=a.byteLength,c=2;while(c+1<r){if(255===a.getUint8(c)&&225===a.getUint8(c+1)){o=c;break}c+=1}}if(o){var l=o+4,h=o+10;if("Exif"===I(a,l,4)){var s=a.getUint16(h);if(i=18761===s,(i||19789===s)&&42===a.getUint16(h+2,i)){var u=a.getUint32(h+4,i);u>=8&&(n=h+u)}}}if(n){var g,d,p=a.getUint16(n,i);for(d=0;d<p;d+=1)if(g=n+12*d+2,274===a.getUint16(g,i)){g+=8,t=a.getUint16(g,i),a.setUint16(g,1,i);break}}}catch(f){t=1}return t}function S(e){var t=null;return new Promise((function(a,i){if(e)if(/^data:/i.test(e))t=j(e),a(t);else if(/^blob:/i.test(e)){var o=new FileReader;o.onload=function(e){t=e.target.result,a(t)},O(e,(function(e){o.readAsArrayBuffer(e)}))}else{var n=new XMLHttpRequest;n.onload=function(){if(200!=this.status&&0!==this.status)throw"Could not load image";t=n.response,a(t),n=null},n.open("GET",e,!0),n.responseType="arraybuffer",n.send(null)}else i("img error")}))}function C(e){var t=0,a=1,i=1;switch(e){case 2:a=-1;break;case 3:t=-180;break;case 4:i=-1;break;case 5:t=90,i=-1;break;case 6:t=90;break;case 7:t=90,a=-1;break;case 8:t=-90;break}return{rotate:t,scaleX:a,scaleY:i}}var M={name:"Cropper",inheritAttrs:!1,props:{cropSize:{type:Number,default:150},imagePath:String,fileType:String,imageType:{type:String,default:"image/jpeg"},quality:{type:Number,default:.9},fixedBox:{type:Boolean,default:!1},showOutputSize:{type:Boolean,default:!0},mode:String,maxImgSize:{type:Number,default:2e3}},emits:["save","cancel"],setup:function(e,t){var a=t.emit,o=Object(i["n"])({img:"",originalImage:{width:0,height:0,left:0,top:0,rotate:0,scale:0},cropBox:{width:0,height:0,left:0,top:0},outputSize:{width:0,height:0},loadComplete:!1}),n=Object(i["o"])(),c=document.createElement("canvas"),l=c.getContext("2d"),h=Object(i["o"])(),s=null,u=!1,g={originalImageLeft:0,originalImageTop:0,cropLeft:0,cropTop:0,cropWidth:0,cropHeight:0,touches:[]},d=Object(i["c"])((function(){return"scale"===e.mode?{width:Math.floor(o.outputSize.width*o.originalImage.scale),height:Math.floor(o.outputSize.height*o.originalImage.scale)}:{width:o.outputSize.width,height:o.outputSize.height}})),p=function(t,a,i,o){var n=C(o),r=n.rotate;switch(l.save(),l.clearRect(0,0,c.width,c.height),c.width=a,c.height=i,6!==o&&8!==o||(c.width=i,c.height=a),o){case 3:l.translate(a/2,i/2),l.rotate(r*Math.PI/180),l.translate(-a/2,-i/2);break;case 6:l.translate(i/2,a/2),l.rotate(r*Math.PI/180),l.translate(-a/2,-i/2);break;case 8:l.translate(i/2,a/2),l.rotate(r*Math.PI/180),l.translate(-a/2,-i/2);break}return l.drawImage(t,0,0,a,i),l.restore(),c.toDataURL(e.imageType,1)},f=function(){e.imagePath&&S(e.imagePath).then((function(t){var a=k(t),i=new Image;i.onload=function(t){var n=t.target,r=n.width,l=n.height,h=e.maxImgSize;if(1===a&&(!h||r<=h&&l<=h))o.img=e.imagePath,o.originalImage.width=r,o.originalImage.height=l;else{if(h&&(r>h||l>h)){var s=Math.min(h/r,h/l);r*=s,l*=s}o.img=p(i,r,l,a),o.originalImage.width=c.width,o.originalImage.height=c.height}o.loadComplete=!0,b()},i.src=y(t,e.imageType)}))};Object(i["j"])((function(){f()})),Object(i["s"])((function(){return e.imagePath}),(function(e,t){e!==t&&f()}));var b=function(){var t=o.originalImage,a=t.width,i=t.height,r=1;if(a>n.value.clientWidth||i>n.value.clientHeight){var c=n.value.clientWidth/a,l=n.value.clientHeight/i;r=Math.min(c,l)}o.originalImage.left=(n.value.clientWidth-a)/2,o.originalImage.top=(n.value.clientHeight-i)/2,o.originalImage.rotate=0,o.originalImage.scale=r,o.cropBox.width=e.cropSize,o.cropBox.height=e.cropSize,o.cropBox.left=(n.value.clientWidth-e.cropSize)/2,o.cropBox.top=(n.value.clientHeight-e.cropSize)/2,m()},v=function(){var e=o.originalImage,t=e.scale,a=e.rotate,i=e.width,n=e.height,r=e.left,c=e.top,l=i*(1-t)/2,h=n*(1-t)/2,s=Math.ceil((o.cropBox.left-(r+l))/t),u=Math.ceil((o.cropBox.top-(c+h))/t),g=Math.ceil(o.cropBox.width/t),d=Math.ceil(o.cropBox.height/t);return 90!==a&&270!==a||(s-=(i-n)/2,u-=(n-i)/2),{x:s,y:u,w:g,h:d}},m=function(){var e=v(),t=e.x,a=e.y,i=e.w,n=e.h,r=o.originalImage,c=r.rotate,l=r.width,h=r.height,s=l,u=h;90!==c&&270!==c||(s=h,u=l);var g=i,d=n;t<0?g=t+i>s?s:t+i:t+i>s&&(g=s-t),a<0?d=a+n>u?u:a+n:a+n>u&&(d=u-a),(g<0||d<0)&&(g=d=0),o.outputSize.width=g,o.outputSize.height=d},w=function(){var e=o.originalImage.rotate+90;e>=360&&(e=0),o.originalImage.rotate=e,m()},O=function(){b()},j=function(e){s=e.target.dataset.name,g.originalImageLeft=o.originalImage.left,g.originalImageTop=o.originalImage.top,g.cropLeft=o.cropBox.left,g.cropTop=o.cropBox.top,g.cropWidth=o.cropBox.width,g.cropHeight=o.cropBox.height,g.touches=e.touches,g.touches.length>1&&(u=!0)},I=function(e){var t=o.originalImage.scale,a={x:g.touches[0].clientX,y:g.touches[0].clientY},i={x:e.touches[0].clientX,y:e.touches[0].clientY},n={x:g.touches[1].clientX,y:g.touches[1].clientY},r={x:e.touches[1].clientX,y:e.touches[1].clientY},c=Math.sqrt(Math.pow(a.x-n.x,2)+Math.pow(a.y-n.y,2)),l=Math.sqrt(Math.pow(i.x-r.x,2)+Math.pow(i.y-r.y,2)),h=l-c,s=1;s=s/o.originalImage.width>s/o.originalImage.height?s/o.originalImage.height:s/o.originalImage.width,s=s>.1?.1:s;var u=s*h;h>0?t+=Math.abs(u):h<0&&t>Math.abs(u)&&(t-=Math.abs(u)),t>1?t=1:t<.001&&(t=0),o.originalImage.scale=t,g.touches=e.touches,m()},M=function(e){if(e.preventDefault(),2!==e.touches.length){if(!u){var t=g.touches,a=g.originalImageLeft,i=g.originalImageTop,r=g.cropLeft,c=g.cropTop,l=g.cropWidth,h=g.cropHeight,d=e.touches[0].clientX-t[0].clientX,p=e.touches[0].clientY-t[0].clientY;if(s){var f=r,b=c,v=l,w=h;switch(s){case"dot-tl":v=l-d,w=h-p,f=r+d,b=c+p;break;case"dot-tc":w=h-p,b=c+p;break;case"dot-tr":v=l+d,w=h-p,b=c+p;break;case"dot-rc":v=l+d;break;case"dot-rb":v=l+d,w=h+p;break;case"dot-bc":w=h+p;break;case"dot-bl":v=l-d,w=h+p,f=r+d;break;case"dot-lc":v=l-d,f=r+d;break;case"mask":f=r+d,b=c+p;break}f<0&&(f=0),b<0&&(b=0),f>n.value.clientWidth&&(f=n.value.clientWidth),b>n.value.clientHeight&&(b=n.value.clientHeight),f>n.value.clientWidth-v&&(f=n.value.clientWidth-v),b>n.value.clientHeight-w&&(b=n.value.clientHeight-w),v>n.value.clientWidth&&(v=n.value.clientWidth,f=0),w>n.value.clientHeight&&(w=n.value.clientHeight,b=0),v<0&&(v=0),w<0&&(w=0),o.cropBox.left=f,o.cropBox.top=b,o.cropBox.width=v,o.cropBox.height=w}else o.originalImage.left=a+d,o.originalImage.top=i+p;m()}}else I(e)},T=function(e){0===e.touches.length&&(u=!1)},B=function(){var t=v(),i=t.x,n=t.y,r=o.outputSize,s=r.width,u=r.height,g=o.originalImage,d=g.rotate,p=g.width,f=g.height;switch(i=i<0?0:i,n=n<0?0:n,l.save(),l.clearRect(0,0,c.width,c.height),c.width=s,c.height=u,d){case 0:l.drawImage(h.value,i,n,s,u,0,0,s,u);break;case 90:l.translate(f,0),l.rotate(d/180*Math.PI),l.drawImage(h.value,n,-(i-f)-s,u,s,0,f-s,u,s);break;case 180:l.translate(p,f),l.rotate(d/180*Math.PI),l.drawImage(h.value,-i+p-s,-n+f-u,s,u,p-s,f-u,s,u);break;case 270:l.translate(0,p),l.rotate(d/180*Math.PI),l.drawImage(h.value,-(n-p)-u,i,u,s,p-u,0,u,s);break}l.restore();var b=c;if("scale"===e.mode){var m=document.createElement("canvas"),w=m.getContext("2d");m.width=s*o.originalImage.scale,m.height=u*o.originalImage.scale,w.scale(m.width/s,m.height/u),w.drawImage(c,0,0),b=m}var y=b.toDataURL(e.imageType,e.quality);"blob"===e.fileType&&(y=x(y)),a("save",y)},P=function(){b(),a("cancel")};return Object(r["a"])(Object(r["a"])({stage:n,imageRef:h},Object(i["r"])(o)),{},{onTouchStart:j,onTouchMove:M,onTouchEnd:T,onRotate:w,onReset:O,onCrop:B,onCancel:P,outputSizeInfo:d})}};a("890e");M.render=m,M.__scopeId="data-v-e3713b5c";var T=M;T.install=function(e){return e.component(T.name,T)};var B=T,P=Object(i["d"])(h);P.use(B),P.mount("#app")},"890e":function(e,t,a){"use strict";a("1d75")}});
//# sourceMappingURL=app.34123145.js.map