(function(e){function t(t){for(var o,c,r=t[0],l=t[1],d=t[2],p=0,g=[];p<r.length;p++)c=r[p],Object.prototype.hasOwnProperty.call(i,c)&&i[c]&&g.push(i[c][0]),i[c]=0;for(o in l)Object.prototype.hasOwnProperty.call(l,o)&&(e[o]=l[o]);h&&h(t);while(g.length)g.shift()();return n.push.apply(n,d||[]),a()}function a(){for(var e,t=0;t<n.length;t++){for(var a=n[t],o=!0,r=1;r<a.length;r++){var l=a[r];0!==i[l]&&(o=!1)}o&&(n.splice(t--,1),e=c(c.s=a[0]))}return e}var o={},i={app:0},n=[];function c(t){if(o[t])return o[t].exports;var a=o[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,c),a.l=!0,a.exports}c.m=e,c.c=o,c.d=function(e,t,a){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(c.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)c.d(a,o,function(t){return e[t]}.bind(null,o));return a},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],l=r.push.bind(r);r.push=t,r=r.slice();for(var d=0;d<r.length;d++)t(r[d]);var h=l;n.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"4bf8":function(e,t,a){"use strict";a("e3d5")},"56d7":function(e,t,a){"use strict";a.r(t);a("e260"),a("e6cf"),a("cca6"),a("a79d");var o=a("7a23"),i={class:"home"};function n(e,t,a,n,c,r){var l=Object(o["o"])("Cropper");return Object(o["j"])(),Object(o["d"])("div",i,[Object(o["g"])("input",{type:"file",accept:"image/*",onChange:t[1]||(t[1]=function(){return n.onChange&&n.onChange.apply(n,arguments)})},null,32),e.previewImage?(Object(o["j"])(),Object(o["d"])("img",{key:0,src:e.previewImage,alt:"预览图",style:{"max-width":"100%","max-height":"100%"}},null,8,["src"])):Object(o["e"])("",!0),e.cropperVisible?(Object(o["j"])(),Object(o["d"])(l,{key:1,imagePath:e.imagePath,fileType:"blob",onSave:n.onSave,onCancel:n.onCancel},null,8,["imagePath","onSave","onCancel"])):Object(o["e"])("",!0)])}a("d3b7"),a("3ca3"),a("ddb0"),a("2b3d");var c=a("5530"),r={name:"App",setup:function(){var e=Object(o["m"])({cropperVisible:!1,imagePath:"",previewImage:null}),t=function(t){var a=t.target.files[0],o=new FileReader;o.onload=function(){e.imagePath=o.result,e.cropperVisible=!0},o.readAsDataURL(a)},a=function(t){e.previewImage="string"===typeof t?t:window.URL.createObjectURL(t),e.cropperVisible=!1},i=function(){e.cropperVisible=!1};return Object(c["a"])(Object(c["a"])({},Object(o["q"])(e)),{},{onChange:t,onSave:a,onCancel:i})}};r.render=n;var l=r,d=(a("b0c0"),a("99af"),Object(o["r"])("data-v-faf68f52"));Object(o["l"])("data-v-faf68f52");var h={class:"face"},p={key:0,class:"size-num"},g=Object(o["f"])('<div class="mask" data-name="mask" data-v-faf68f52></div><div class="line-top" data-v-faf68f52></div><div class="line-right" data-v-faf68f52></div><div class="line-bottom" data-v-faf68f52></div><div class="line-left" data-v-faf68f52></div>',5),s=Object(o["f"])('<div class="dot-tl" data-name="dot-tl" data-v-faf68f52></div><div class="dot-tc" data-name="dot-tc" data-v-faf68f52></div><div class="dot-tr" data-name="dot-tr" data-v-faf68f52></div><div class="dot-rc" data-name="dot-rc" data-v-faf68f52></div><div class="dot-rb" data-name="dot-rb" data-v-faf68f52></div><div class="dot-bc" data-name="dot-bc" data-v-faf68f52></div><div class="dot-bl" data-name="dot-bl" data-v-faf68f52></div><div class="dot-lc" data-name="dot-lc" data-v-faf68f52></div>',8),u={class:"cropper__control"},f=Object(o["g"])("div",{class:"cropper__line"},null,-1),v={class:"cropper__control"},b={style:{height:"0",overflow:"hidden",position:"absolute",left:"9999px"}};Object(o["k"])();var m=d((function(e,t,a,i,n,c){return Object(o["j"])(),Object(o["d"])(o["b"],{to:"body"},[Object(o["g"])("div",Object(o["h"])({class:"cropper"},e.$attrs),[Object(o["g"])("div",{ref:"stage",class:"cropper__stage",onTouchstart:t[2]||(t[2]=function(){return i.onTouchStart&&i.onTouchStart.apply(i,arguments)}),onTouchmove:t[3]||(t[3]=function(){return i.onTouchMove&&i.onTouchMove.apply(i,arguments)}),onTouchend:t[4]||(t[4]=function(){return i.onTouchEnd&&i.onTouchEnd.apply(i,arguments)}),style:{visibility:e.loadComplete?"visible":"hidden"}},[Object(o["g"])("img",{class:"cropper__img",ref:"imageRef",src:a.imagePath,alt:"",style:{transform:"translate3d(".concat(e.originalImage.left,"px,").concat(e.originalImage.top,"px,0) rotateZ(").concat(e.originalImage.rotate,"deg) scale(").concat(e.originalImage.scale,")")},onLoad:t[1]||(t[1]=function(){return i.onLoadComplete&&i.onLoadComplete.apply(i,arguments)})},null,44,["src"]),Object(o["g"])("div",{class:"cropper__box",style:{width:"".concat(e.cropBox.width,"px"),height:"".concat(e.cropBox.height,"px"),transform:"translate3d(".concat(e.cropBox.left,"px,").concat(e.cropBox.top,"px,0)")}},[Object(o["g"])("div",h,[Object(o["g"])("img",{src:a.imagePath,alt:"",style:{transform:"translate3d(".concat(e.originalImage.left-e.cropBox.left,"px,").concat(e.originalImage.top-e.cropBox.top,"px,0) rotateZ(").concat(e.originalImage.rotate,"deg) scale(").concat(e.originalImage.scale,")")}},null,12,["src"])]),a.showOutSize?(Object(o["j"])(),Object(o["d"])("div",p,Object(o["p"])("".concat(e.outSize.width," x ").concat(e.outSize.height)),1)):Object(o["e"])("",!0),g,a.fixedBox?Object(o["e"])("",!0):(Object(o["j"])(),Object(o["d"])(o["a"],{key:1},[s],64))],4)],36),Object(o["g"])("div",u,[Object(o["g"])("div",{class:"cropper__icon-rotate",onClick:t[5]||(t[5]=function(){return i.onRotate&&i.onRotate.apply(i,arguments)})})]),f,Object(o["g"])("div",v,[Object(o["g"])("span",{onClick:t[6]||(t[6]=function(){return i.onCancel&&i.onCancel.apply(i,arguments)})},"取消"),Object(o["g"])("span",{onClick:t[7]||(t[7]=function(){return i.onReset&&i.onReset.apply(i,arguments)})},"还原"),Object(o["g"])("span",{onClick:t[8]||(t[8]=function(){return i.onCrop&&i.onCrop.apply(i,arguments)})},"选取")]),Object(o["g"])("view",b,[Object(o["g"])("canvas",{ref:"canvasRef",width:e.canvas.width,height:e.canvas.height},null,8,["width","height"])])],16)])})),j=(a("a9e3"),a("ac1f"),a("466d"),a("1276"),a("5cc6"),a("9a8c"),a("a975"),a("735e"),a("c1ac"),a("d139"),a("3a7b"),a("d5d6"),a("82f8"),a("e91f"),a("60bd"),a("5f96"),a("3280"),a("3fcc"),a("ca91"),a("25a1"),a("cd26"),a("3c5d"),a("2954"),a("649e"),a("219c"),a("170b"),a("b39a"),a("72f7"),{name:"Cropper",inheritAttrs:!1,props:{cropSize:{type:Number,default:150},imagePath:String,fileType:String,imageType:{type:String,default:"image/jpeg"},quality:{type:Number,default:.9},fixedBox:{type:Boolean,default:!1},showOutSize:{type:Boolean,default:!0}},emits:["save","cancel"],setup:function(e,t){var a=t.emit,i=Object(o["m"])({originalImage:{width:0,height:0,left:0,top:0,rotate:0,scale:0},cropBox:{width:0,height:0,left:0,top:0},canvas:{width:0,height:0},outSize:{width:0,height:0},loadComplete:!1}),n=Object(o["n"])(),r=Object(o["n"])(),l=null,d=Object(o["n"])(),h=null,p=!1,g={originalImageLeft:0,originalImageTop:0,cropLeft:0,cropTop:0,cropWidth:0,cropHeight:0,touches:[]};Object(o["i"])((function(){l=r.value.getContext("2d")}));var s=function(e){i.originalImage.width=e.target.naturalWidth,i.originalImage.height=e.target.naturalHeight,i.loadComplete=!0,u()},u=function(){var t=i.originalImage,a=t.width,o=t.height,c=1;if(a>n.value.clientWidth||o>n.value.clientHeight){var r=n.value.clientWidth/a,l=n.value.clientHeight/o;c=Math.min(r,l)}i.originalImage.left=(n.value.clientWidth-a)/2,i.originalImage.top=(n.value.clientHeight-o)/2,i.originalImage.rotate=0,i.originalImage.scale=c,i.cropBox.width=e.cropSize,i.cropBox.height=e.cropSize,i.cropBox.left=(n.value.clientWidth-e.cropSize)/2,i.cropBox.top=(n.value.clientHeight-e.cropSize)/2,b(a,o),v()},f=function(){var e=i.originalImage,t=e.scale,a=e.rotate,o=e.width,n=e.height,c=e.left,r=e.top,l=o*(1-t)/2,d=n*(1-t)/2,h=Math.ceil((i.cropBox.left-(c+l))/t),p=Math.ceil((i.cropBox.top-(r+d))/t),g=Math.ceil(i.cropBox.width/t),s=Math.ceil(i.cropBox.height/t);return 90!==a&&270!==a||(h-=(o-n)/2,p-=(n-o)/2),{x:h,y:p,w:g,h:s}},v=function(){var e=f(),t=e.x,a=e.y,o=e.w,n=e.h,c=i.canvas,r=c.width,l=c.height,d=o,h=n;t<0?d=t+o>r?r:t+o:t+o>r&&(d=r-t),a<0?h=a+n>l?l:a+n:a+n>l&&(h=l-a),(d<0||h<0)&&(d=h=0),i.outSize.width=d,i.outSize.height=h},b=function(e,t){i.canvas.width=e,i.canvas.height=t},m=function(){var e=i.originalImage.rotate+90;e>=360&&(e=0),0===e||180===e?b(i.originalImage.width,i.originalImage.height):90!==e&&270!==e||b(i.originalImage.height,i.originalImage.width),i.originalImage.rotate=e,v()},j=function(){u()},w=function(e){h=e.target.dataset.name,g.originalImageLeft=i.originalImage.left,g.originalImageTop=i.originalImage.top,g.cropLeft=i.cropBox.left,g.cropTop=i.cropBox.top,g.cropWidth=i.cropBox.width,g.cropHeight=i.cropBox.height,g.touches=e.touches,g.touches.length>1&&(p=!0)},O=function(e){var t=i.originalImage.scale,a={x:g.touches[0].clientX,y:g.touches[0].clientY},o={x:e.touches[0].clientX,y:e.touches[0].clientY},n={x:g.touches[1].clientX,y:g.touches[1].clientY},c={x:e.touches[1].clientX,y:e.touches[1].clientY},r=Math.sqrt(Math.pow(a.x-n.x,2)+Math.pow(a.y-n.y,2)),l=Math.sqrt(Math.pow(o.x-c.x,2)+Math.pow(o.y-c.y,2)),d=l-r,h=1;h=h/i.originalImage.width>h/i.originalImage.height?h/i.originalImage.height:h/i.originalImage.width,h=h>.1?.1:h;var p=h*d;d>0?t+=Math.abs(p):d<0&&t>Math.abs(p)&&(t-=Math.abs(p)),t>1?t=1:t<.001&&(t=0),i.originalImage.scale=t,g.touches=e.touches,v()},y=function(e){if(e.preventDefault(),2!==e.touches.length){if(!p){var t=g.touches,a=g.originalImageLeft,o=g.originalImageTop,c=g.cropLeft,r=g.cropTop,l=g.cropWidth,d=g.cropHeight,s=e.touches[0].clientX-t[0].clientX,u=e.touches[0].clientY-t[0].clientY;if(h){var f=c,b=r,m=l,j=d;switch(h){case"dot-tl":m=l-s,j=d-u,f=c+s,b=r+u;break;case"dot-tc":j=d-u,b=r+u;break;case"dot-tr":m=l+s,j=d-u,b=r+u;break;case"dot-rc":m=l+s;break;case"dot-rb":m=l+s,j=d+u;break;case"dot-bc":j=d+u;break;case"dot-bl":m=l-s,j=d+u,f=c+s;break;case"dot-lc":m=l-s,f=c+s;break;case"mask":f=c+s,b=r+u;break}f<0&&(f=0),b<0&&(b=0),f>n.value.clientWidth&&(f=n.value.clientWidth),b>n.value.clientHeight&&(b=n.value.clientHeight),f>n.value.clientWidth-m&&(f=n.value.clientWidth-m),b>n.value.clientHeight-j&&(b=n.value.clientHeight-j),m>n.value.clientWidth&&(m=n.value.clientWidth,f=0),j>n.value.clientHeight&&(j=n.value.clientHeight,b=0),m<0&&(m=0),j<0&&(j=0),i.cropBox.left=f,i.cropBox.top=b,i.cropBox.width=m,i.cropBox.height=j}else i.originalImage.left=a+s,i.originalImage.top=o+u;v()}}else O(e)},x=function(e){0===e.touches.length&&(p=!1)},I=function(){var e=f(),t=e.x,a=e.y,o=i.outSize,n=o.width,c=o.height,r=i.originalImage,h=r.rotate,p=r.width,g=r.height;switch(t=t<0?0:t,a=a<0?0:a,l.save(),l.clearRect(0,0,i.canvas.width,i.canvas.height),h){case 0:l.drawImage(d.value,t,a,n,c,t,a,n,c);break;case 90:l.translate(g,0),l.rotate(h/180*Math.PI),l.drawImage(d.value,a,-(t-g)-n,c,n,a,-(t-g)-n,c,n);break;case 180:l.translate(p,g),l.rotate(h/180*Math.PI),l.drawImage(d.value,-t+p-n,-a+g-c,n,c,-t+p-n,-a+g-c,n,c);break;case 270:l.translate(0,p),l.rotate(h/180*Math.PI),l.drawImage(d.value,-(a-p)-c,t,c,n,-(a-p)-c,t,c,n);break}B(t,a,n,c)},C=function(e){var t=e.split(","),a=t[0].match(/:(.*?);/)[1],o=window.atob(t[1]),i=o.length,n=new Uint8Array(i);while(i--)n[i]=o.charCodeAt(i);return new Blob([n],{type:a})},k=function(t,a,o){var i=document.createElement("canvas"),n=i.getContext("2d");return i.width=a,i.height=o,n.putImageData(t,0,0),i.toDataURL(e.imageType,e.quality)},B=function(t,o,i,n){l.restore();var c=k(l.getImageData(t,o,i,n),i,n);"blob"===e.fileType&&(c=C(c)),a("save",c)},S=function(){u(),a("cancel")};return Object(c["a"])(Object(c["a"])({stage:n,canvasRef:r,imageRef:d,onLoadComplete:s},Object(o["q"])(i)),{},{onTouchStart:w,onTouchMove:y,onTouchEnd:x,onRotate:m,onReset:j,onCrop:I,onCancel:S})}});a("4bf8");j.render=m,j.__scopeId="data-v-faf68f52";var w=j;w.install=function(e){return e.component(w.name,w)};var O=w,y=Object(o["c"])(l);y.use(O),y.mount("#app")},e3d5:function(e,t,a){}});
//# sourceMappingURL=app.0dcd27a1.js.map