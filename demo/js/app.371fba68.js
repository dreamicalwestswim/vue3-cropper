(function(e){function t(t){for(var o,r,c=t[0],l=t[1],s=t[2],h=0,d=[];h<c.length;h++)r=c[h],Object.prototype.hasOwnProperty.call(i,r)&&i[r]&&d.push(i[r][0]),i[r]=0;for(o in l)Object.prototype.hasOwnProperty.call(l,o)&&(e[o]=l[o]);u&&u(t);while(d.length)d.shift()();return n.push.apply(n,s||[]),a()}function a(){for(var e,t=0;t<n.length;t++){for(var a=n[t],o=!0,c=1;c<a.length;c++){var l=a[c];0!==i[l]&&(o=!1)}o&&(n.splice(t--,1),e=r(r.s=a[0]))}return e}var o={},i={app:0},n=[];function r(t){if(o[t])return o[t].exports;var a=o[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=e,r.c=o,r.d=function(e,t,a){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(a,o,function(t){return e[t]}.bind(null,o));return a},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],l=c.push.bind(c);c.push=t,c=c.slice();for(var s=0;s<c.length;s++)t(c[s]);var u=l;n.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"0aa4":function(e,t,a){},"56d7":function(e,t,a){"use strict";a.r(t);a("e260"),a("e6cf"),a("cca6"),a("a79d");var o=a("7a23"),i={class:"home"};function n(e,t,a,n,r,c){var l=Object(o["p"])("Cropper");return Object(o["k"])(),Object(o["e"])("div",i,[Object(o["h"])("input",{type:"file",accept:"image/*",onChange:t[1]||(t[1]=function(){return n.onChange&&n.onChange.apply(n,arguments)})},null,32),e.previewImage?(Object(o["k"])(),Object(o["e"])("img",{key:0,src:e.previewImage,alt:"预览图",style:{"max-width":"100%","max-height":"100%"}},null,8,["src"])):Object(o["f"])("",!0),e.cropperVisible?(Object(o["k"])(),Object(o["e"])(l,{key:1,imagePath:e.imagePath,fileType:"blob",onSave:n.onSave,onCancel:n.onCancel},null,8,["imagePath","onSave","onCancel"])):Object(o["f"])("",!0)])}a("d3b7"),a("3ca3"),a("ddb0"),a("2b3d");var r=a("5530"),c=window.URL||window.webkitURL,l={name:"App",setup:function(){var e=Object(o["n"])({cropperVisible:!1,imagePath:"",previewImage:null}),t=function(t){var a=t.target.files[0];e.imagePath=c.createObjectURL(a),e.cropperVisible=!0},a=function(t){e.previewImage="string"===typeof t?t:c.createObjectURL(t),e.cropperVisible=!1},i=function(){e.cropperVisible=!1};return Object(r["a"])(Object(r["a"])({},Object(o["r"])(e)),{},{onChange:t,onSave:a,onCancel:i})}};l.render=n;var s=l,u=(a("b0c0"),a("99af"),Object(o["t"])("data-v-eceba84e"));Object(o["m"])("data-v-eceba84e");var h={class:"face"},d={key:0,class:"size-num"},p=Object(o["g"])('<div class="mask" data-name="mask" data-v-eceba84e></div><div class="line-top" data-v-eceba84e></div><div class="line-right" data-v-eceba84e></div><div class="line-bottom" data-v-eceba84e></div><div class="line-left" data-v-eceba84e></div>',5),g=Object(o["g"])('<div class="dot-tl" data-name="dot-tl" data-v-eceba84e></div><div class="dot-tc" data-name="dot-tc" data-v-eceba84e></div><div class="dot-tr" data-name="dot-tr" data-v-eceba84e></div><div class="dot-rc" data-name="dot-rc" data-v-eceba84e></div><div class="dot-rb" data-name="dot-rb" data-v-eceba84e></div><div class="dot-bc" data-name="dot-bc" data-v-eceba84e></div><div class="dot-bl" data-name="dot-bl" data-v-eceba84e></div><div class="dot-lc" data-name="dot-lc" data-v-eceba84e></div>',8),f={class:"cropper__control"},v=Object(o["h"])("div",{class:"cropper__line"},null,-1),b={class:"cropper__control"};Object(o["l"])();var m=u((function(e,t,a,i,n,r){return Object(o["k"])(),Object(o["e"])(o["b"],{to:"body"},[Object(o["h"])("div",Object(o["i"])({class:"cropper"},e.$attrs),[Object(o["h"])("div",{ref:"stage",class:"cropper__stage",onTouchstart:t[1]||(t[1]=function(){return i.onTouchStart&&i.onTouchStart.apply(i,arguments)}),onTouchmove:t[2]||(t[2]=function(){return i.onTouchMove&&i.onTouchMove.apply(i,arguments)}),onTouchend:t[3]||(t[3]=function(){return i.onTouchEnd&&i.onTouchEnd.apply(i,arguments)}),onMousedown:t[4]||(t[4]=function(){return i.onTouchStart&&i.onTouchStart.apply(i,arguments)}),style:{visibility:e.loadComplete?"visible":"hidden"}},[Object(o["h"])("img",{class:"cropper__img",ref:"imageRef",src:e.img,alt:"",style:{transform:"translate3d(".concat(e.originalImage.left,"px,").concat(e.originalImage.top,"px,0) rotateZ(").concat(e.originalImage.rotate,"deg) scale(").concat(e.originalImage.scale,")")}},null,12,["src"]),Object(o["h"])("div",{class:"cropper__box",style:{width:"".concat(e.cropBox.width,"px"),height:"".concat(e.cropBox.height,"px"),transform:"translate3d(".concat(e.cropBox.left,"px,").concat(e.cropBox.top,"px,0)")}},[Object(o["h"])("div",h,[Object(o["h"])("img",{src:e.img,alt:"",style:{transform:"translate3d(".concat(e.originalImage.left-e.cropBox.left,"px,").concat(e.originalImage.top-e.cropBox.top,"px,0) rotateZ(").concat(e.originalImage.rotate,"deg) scale(").concat(e.originalImage.scale,")")}},null,12,["src"])]),a.showOutputSize?(Object(o["k"])(),Object(o["e"])("div",d,Object(o["q"])("".concat(i.outputSizeInfo.width," x ").concat(i.outputSizeInfo.height)),1)):Object(o["f"])("",!0),p,a.fixedBox?Object(o["f"])("",!0):(Object(o["k"])(),Object(o["e"])(o["a"],{key:1},[g],64))],4)],36),Object(o["h"])("div",f,[Object(o["h"])("div",{class:"cropper__icon-rotate",onClick:t[5]||(t[5]=function(){return i.onRotate&&i.onRotate.apply(i,arguments)})})]),v,Object(o["h"])("div",b,[Object(o["h"])("span",{onClick:t[6]||(t[6]=function(){return i.onCancel&&i.onCancel.apply(i,arguments)})},"取消"),Object(o["h"])("span",{onClick:t[7]||(t[7]=function(){return i.onReset&&i.onReset.apply(i,arguments)})},"还原"),Object(o["h"])("span",{onClick:t[8]||(t[8]=function(){return i.onCrop&&i.onCrop.apply(i,arguments)})},"选取")])],16)])}));a("a9e3"),a("a630"),a("a15b"),a("fb6a"),a("c19f"),a("ac1f"),a("466d"),a("5319"),a("1276"),a("5cc6"),a("9a8c"),a("a975"),a("735e"),a("c1ac"),a("d139"),a("3a7b"),a("d5d6"),a("82f8"),a("e91f"),a("60bd"),a("5f96"),a("3280"),a("3fcc"),a("ca91"),a("25a1"),a("cd26"),a("3c5d"),a("2954"),a("649e"),a("219c"),a("170b"),a("b39a"),a("72f7");function w(e){return Array.from?Array.from(e):Array.slice.call(e)}function y(e,t){var a=[],o=8192,i=new Uint8Array(e);while(i.length>0)a.push(String.fromCharCode.apply(null,w(i.subarray(0,o)))),i=i.subarray(o);return"data:".concat(t,";base64,").concat(btoa(a.join("")))}function I(e,t){var a=new XMLHttpRequest;a.open("GET",e,!0),a.responseType="blob",a.onload=function(){200!=this.status&&0!==this.status||t(this.response)},a.send()}function O(e){var t=e.replace(/^data:.*,/,""),a=atob(t),o=new ArrayBuffer(a.length),i=new Uint8Array(o),n=a.length;while(n--)i[n]=a.charCodeAt(n);return o}function j(e,t,a){var o,i="";for(o=t,a+=t;o<a;o++)i+=String.fromCharCode(e.getUint8(o));return i}function x(e){var t=e.split(","),a=t[0].match(/:(.*?);/)[1],o=window.atob(t[1]),i=o.length,n=new Uint8Array(i);while(i--)n[i]=o.charCodeAt(i);return new Blob([n],{type:a})}function k(e){var t,a=new DataView(e);try{var o,i,n;if(255===a.getUint8(0)&&216===a.getUint8(1)){var r=a.byteLength,c=2;while(c+1<r){if(255===a.getUint8(c)&&225===a.getUint8(c+1)){i=c;break}c+=1}}if(i){var l=i+4,s=i+10;if("Exif"===j(a,l,4)){var u=a.getUint16(s);if(o=18761===u,(o||19789===u)&&42===a.getUint16(s+2,o)){var h=a.getUint32(s+4,o);h>=8&&(n=s+h)}}}if(n){var d,p,g=a.getUint16(n,o);for(p=0;p<g;p+=1)if(d=n+12*p+2,274===a.getUint16(d,o)){d+=8,t=a.getUint16(d,o),a.setUint16(d,1,o);break}}}catch(f){t=1}return t}function S(e){var t=null;return new Promise((function(a,o){if(e)if(/^data:/i.test(e))t=O(e),a(t);else if(/^blob:/i.test(e)){var i=new FileReader;i.onload=function(e){t=e.target.result,a(t)},I(e,(function(e){i.readAsArrayBuffer(e)}))}else{var n=new XMLHttpRequest;n.onload=function(){if(200!=this.status&&0!==this.status)throw"Could not load image";t=n.response,a(t),n=null},n.open("GET",e,!0),n.responseType="arraybuffer",n.send(null)}else o("img error")}))}function M(e){var t=0,a=1,o=1;switch(e){case 2:a=-1;break;case 3:t=-180;break;case 4:o=-1;break;case 5:t=90,o=-1;break;case 6:t=90;break;case 7:t=90,a=-1;break;case 8:t=-90;break}return{rotate:t,scaleX:a,scaleY:o}}var T={name:"Cropper",inheritAttrs:!1,props:{cropSize:{type:Number,default:200},imagePath:String,fileType:String,imageType:{type:String,default:"image/jpeg"},quality:{type:Number,default:.9},fixedBox:{type:Boolean,default:!1},showOutputSize:{type:Boolean,default:!0},mode:String,maxImgSize:{type:Number,default:2e3}},emits:["save","cancel"],setup:function(e,t){var a=t.emit,i=Object(o["n"])({img:"",originalImage:{width:0,height:0,left:0,top:0,rotate:0,scale:0},cropBox:{width:0,height:0,left:0,top:0},outputSize:{width:0,height:0},loadComplete:!1}),n=Object(o["o"])(),c=document.createElement("canvas"),l=c.getContext("2d"),s=Object(o["o"])(),u=null,h=!1,d={originalImageLeft:0,originalImageTop:0,cropLeft:0,cropTop:0,cropWidth:0,cropHeight:0,touches:[],mouseInfo:{}},p=Object(o["c"])((function(){return"scale"===e.mode?{width:Math.floor(i.outputSize.width*i.originalImage.scale),height:Math.floor(i.outputSize.height*i.originalImage.scale)}:{width:i.outputSize.width,height:i.outputSize.height}})),g=function(t,a,o,i){var n=M(i),r=n.rotate;switch(l.save(),l.clearRect(0,0,c.width,c.height),c.width=a,c.height=o,6!==i&&8!==i||(c.width=o,c.height=a),i){case 3:l.translate(a/2,o/2),l.rotate(r*Math.PI/180),l.translate(-a/2,-o/2);break;case 6:l.translate(o/2,a/2),l.rotate(r*Math.PI/180),l.translate(-a/2,-o/2);break;case 8:l.translate(o/2,a/2),l.rotate(r*Math.PI/180),l.translate(-a/2,-o/2);break}return l.drawImage(t,0,0,a,o),l.restore(),c.toDataURL(e.imageType,1)},f=function(){e.imagePath&&S(e.imagePath).then((function(t){var a=k(t),o=new Image;o.onload=function(t){var n=t.target,r=n.width,l=n.height,s=e.maxImgSize;if(1===a&&(!s||r<=s&&l<=s))i.img=e.imagePath,i.originalImage.width=r,i.originalImage.height=l;else{if(s&&(r>s||l>s)){var u=Math.min(s/r,s/l);r*=u,l*=u}i.img=g(o,r,l,a),i.originalImage.width=c.width,i.originalImage.height=c.height}i.loadComplete=!0,v()},o.src=y(t,e.imageType)}))};Object(o["j"])((function(){f()})),Object(o["s"])((function(){return e.imagePath}),(function(e,t){e!==t&&f()}));var v=function(){var t=i.originalImage,a=t.width,o=t.height,r=1;if(a>n.value.clientWidth||o>n.value.clientHeight){var c=n.value.clientWidth/a,l=n.value.clientHeight/o;r=Math.min(c,l)}i.originalImage.left=(n.value.clientWidth-a)/2,i.originalImage.top=(n.value.clientHeight-o)/2,i.originalImage.rotate=0,i.originalImage.scale=r,i.cropBox.width=e.cropSize,i.cropBox.height=e.cropSize,i.cropBox.left=(n.value.clientWidth-e.cropSize)/2,i.cropBox.top=(n.value.clientHeight-e.cropSize)/2,m()},b=function(){var e=i.originalImage,t=e.scale,a=e.rotate,o=e.width,n=e.height,r=e.left,c=e.top,l=o*(1-t)/2,s=n*(1-t)/2,u=Math.ceil((i.cropBox.left-(r+l))/t),h=Math.ceil((i.cropBox.top-(c+s))/t),d=Math.ceil(i.cropBox.width/t),p=Math.ceil(i.cropBox.height/t);return 90!==a&&270!==a||(u-=(o-n)/2,h-=(n-o)/2),{x:u,y:h,w:d,h:p}},m=function(){var e=b(),t=e.x,a=e.y,o=e.w,n=e.h,r=i.originalImage,c=r.rotate,l=r.width,s=r.height,u=l,h=s;90!==c&&270!==c||(u=s,h=l);var d=o,p=n;t<0?d=t+o>u?u:t+o:t+o>u&&(d=u-t),a<0?p=a+n>h?h:a+n:a+n>h&&(p=h-a),(d<0||p<0)&&(d=p=0),i.outputSize.width=d,i.outputSize.height=p},w=function(){var e=i.originalImage.rotate+90;e>=360&&(e=0),i.originalImage.rotate=e,m()},I=function(){v()},O=function(e){e.preventDefault(),u=e.target.dataset.name,d.originalImageLeft=i.originalImage.left,d.originalImageTop=i.originalImage.top,d.cropLeft=i.cropBox.left,d.cropTop=i.cropBox.top,d.cropWidth=i.cropBox.width,d.cropHeight=i.cropBox.height,e.touches?(d.touches=e.touches,d.touches.length>1&&(h=!0)):(d.mouseInfo.clientX=e.clientX,d.mouseInfo.clientY=e.clientY,window.addEventListener("mousemove",T),window.addEventListener("mouseup",C))},j=function(e){var t=i.originalImage.scale,a={x:d.touches[0].clientX,y:d.touches[0].clientY},o={x:e.touches[0].clientX,y:e.touches[0].clientY},n={x:d.touches[1].clientX,y:d.touches[1].clientY},r={x:e.touches[1].clientX,y:e.touches[1].clientY},c=Math.sqrt(Math.pow(a.x-n.x,2)+Math.pow(a.y-n.y,2)),l=Math.sqrt(Math.pow(o.x-r.x,2)+Math.pow(o.y-r.y,2)),s=l-c,u=1;u=u/i.originalImage.width>u/i.originalImage.height?u/i.originalImage.height:u/i.originalImage.width,u=u>.1?.1:u;var h=u*s;s>0?t+=Math.abs(h):s<0&&t>Math.abs(h)&&(t-=Math.abs(h)),t>1?t=1:t<.001&&(t=0),i.originalImage.scale=t,d.touches=e.touches,m()},T=function(e){if(e.preventDefault(),e.touches&&2===e.touches.length)j(e);else if(!h){var t=d.touches,a=d.mouseInfo,o=d.originalImageLeft,r=d.originalImageTop,c=d.cropLeft,l=d.cropTop,s=d.cropWidth,p=d.cropHeight,g=0,f=0;if(e.touches?(g=e.touches[0].clientX-t[0].clientX,f=e.touches[0].clientY-t[0].clientY):(g=e.clientX-a.clientX,f=e.clientY-a.clientY),u){var v=c,b=l,w=s,y=p;switch(u){case"dot-tl":w=s-g,y=p-f,v=c+g,b=l+f;break;case"dot-tc":y=p-f,b=l+f;break;case"dot-tr":w=s+g,y=p-f,b=l+f;break;case"dot-rc":w=s+g;break;case"dot-rb":w=s+g,y=p+f;break;case"dot-bc":y=p+f;break;case"dot-bl":w=s-g,y=p+f,v=c+g;break;case"dot-lc":w=s-g,v=c+g;break;case"mask":v=c+g,b=l+f;break}v<0&&(v=0),b<0&&(b=0),v>n.value.clientWidth&&(v=n.value.clientWidth),b>n.value.clientHeight&&(b=n.value.clientHeight),v>n.value.clientWidth-w&&(v=n.value.clientWidth-w),b>n.value.clientHeight-y&&(b=n.value.clientHeight-y),w>n.value.clientWidth&&(w=n.value.clientWidth,v=0),y>n.value.clientHeight&&(y=n.value.clientHeight,b=0),w<0&&(w=0),y<0&&(y=0),i.cropBox.left=v,i.cropBox.top=b,i.cropBox.width=w,i.cropBox.height=y}else i.originalImage.left=o+g,i.originalImage.top=r+f;m()}},C=function e(t){t.touches?0===t.touches.length&&(h=!1):(window.removeEventListener("mousemove",T),window.removeEventListener("mouseup",e))},B=function(){var t=b(),o=t.x,n=t.y,r=i.outputSize,u=r.width,h=r.height,d=i.originalImage,p=d.rotate,g=d.width,f=d.height;switch(o=o<0?0:o,n=n<0?0:n,l.save(),l.clearRect(0,0,c.width,c.height),c.width=u,c.height=h,p){case 0:l.drawImage(s.value,o,n,u,h,0,0,u,h);break;case 90:l.translate(f,0),l.rotate(p/180*Math.PI),l.drawImage(s.value,n,-(o-f)-u,h,u,0,f-u,h,u);break;case 180:l.translate(g,f),l.rotate(p/180*Math.PI),l.drawImage(s.value,-o+g-u,-n+f-h,u,h,g-u,f-h,u,h);break;case 270:l.translate(0,g),l.rotate(p/180*Math.PI),l.drawImage(s.value,-(n-g)-h,o,h,u,g-h,0,h,u);break}l.restore();var v=c;if("scale"===e.mode){var m=document.createElement("canvas"),w=m.getContext("2d");m.width=u*i.originalImage.scale,m.height=h*i.originalImage.scale,w.scale(m.width/u,m.height/h),w.drawImage(c,0,0),v=m}var y=v.toDataURL(e.imageType,e.quality);"blob"===e.fileType&&(y=x(y)),a("save",y)},P=function(){v(),a("cancel")};return Object(r["a"])(Object(r["a"])({stage:n,imageRef:s},Object(o["r"])(i)),{},{onTouchStart:O,onTouchMove:T,onTouchEnd:C,onRotate:w,onReset:I,onCrop:B,onCancel:P,outputSizeInfo:p})}};a("9d96");T.render=m,T.__scopeId="data-v-eceba84e";var C=T;C.install=function(e){return e.component(C.name,C)};var B=C,P=Object(o["d"])(s);P.use(B),P.mount("#app")},"9d96":function(e,t,a){"use strict";a("0aa4")}});
//# sourceMappingURL=app.371fba68.js.map